---
tags: 
created: 2023-07-17 19:49:14
aliases: 
DOI:
---

由于在对 [[Kitaev 蜂窝模型|Kitaev 蜂窝模型]]基态的分析中需要分析它的基态, 需要用到精确对角化方法. 

本文基于[[国見昌哉|国见]]的 note.

# 1. 精确对角化

## 1.1. 问题设定

在这里，我们考虑对多体 [[薛定谔方程|Schrödinger 方程]]进行数值对角化。换句话说，对于所考虑系统的哈密顿算符表示为 $\hat{H}$，我们研究时间无关的 Schrödinger 方程。

$$\hat{H} \ket{\varphi_i} = E_i \ket{\varphi_i} \tag{1}$$
它的（全部或部分的）特征值和特征向量。在这里，假设 $\ket{\varphi_i}$ 是第 $i$ 个特征向量，$E_i$ 是第 $i$ 个特征值。此外，以下讨论的是有限自由度的晶格模型。例如，考虑 [[Hubbard 模型|Hubbard 模型]]、海森堡模型等量子自旋系统。

## 1.2. 矩阵表示

由于考虑的是有限自由度的系统，所以希尔伯特空间的维度是有限的。我们将其表示为 $D$. 我们将正交归一的完备集合表示为 $\ket{\vb*{n}}$，其中 $\vb*{n}$ 是基底的标签，在后面会给出具体的示例。向量 $\ket{\vb*{n}}$ 满足

$$\sum_\vb*{n} \op{\vb*{n}}=\mathbb{1}\tag{2}$$
其中 $\mathbb{1}$ 是作用于当前考虑的希尔伯特空间的单位算符，即在矩阵表示中，它是一个大小为 $D×D$ 的单位矩阵。

利用这个关系，可以将 Schrödinger 方程式（1）表示为矩阵形式：
$$
\begin{align}
\mel*{\vb*{n}}{\hat{H}\mathbb{1}}{\varphi_i} &= E_i \ip{\vb*{n}}{\varphi_i}\\
\sum_\vb*{m} \mel*{\vb*{n}}{\hat{H}}{\vb*{m}}\ip{\vb*{m}}{\varphi_i} &= E_i \ip{\vb*{n}}{\varphi_i}\\
\sum_\vb*{m} H_{\vb*{n},\vb*{m}}\ \varphi_{\vb*{m}}^{(i)} &= E_i\ \varphi_{\vb*{n}}^{(i)}
\end{align}\tag{3}
$$

其中
$$H_{\vb*{n},\vb*{m}} = \mel*{\vb*{n}}{\hat{H}}{\vb*{m}}\tag{4}$$
$$ \varphi_{\vb*{n}}^{(1)}=\ip{\vb*{n}}{\varphi_i}\tag{5}$$
经过这些转换，式（3）变成了一个厄米矩阵的特征值问题，为了获得 Schrödinger 方程的特征值和特征向量，只需要对式（3）进行数值对角化即可。

执行精确对角化方法所面临的技术问题主要集中在如何在计算机上准备哈密顿矩阵的矩阵表示（式（4））。一旦矩阵准备好了，剩下的工作就是将其输入到适当的数值对角化库中（或者在某些情况下，使用自己编写的程序），然后对角化就完成了。以下将解释两种准备矩阵元素的方法。

---
## 1.3. 方法一: $M$ 位 $N+1$ 进制

### 1.3.1. $1/2$ 自旋体系

#### 1.3.1.1. 单自旋



首先考虑最简单的情况，即一个自旋 $1/2$ 的粒子定位在一个格点上。在这种情况下，Hilbert 空间由状态 $\ket{\uparrow}$ 和 $\ket{\downarrow}$ 张成。这些状态是自旋 $1/2$ 算符的 $z$ 分量的特征态，即 $\hat{S}^z \ket{\uparrow} = \frac12 \ket{\uparrow},\ \hat{S}^z \ket{\downarrow} = -\frac12 \ket{\downarrow}$. 

出于在计算机上处理的方便考虑，我们引入以下表示：

$$
\ket{0} \equiv \ket{\uparrow},\quad \ket{1} \equiv \ket{\downarrow}\tag{6}
$$
这将有助于在二进制数中表示这些状态。

此时的哈密顿记作矩阵形式
$$H = \mqty[\mel*{0}{\hat{H}}{0}&\mel*{0}{\hat{H}}{1}\\ \mel*{1}{\hat{H}}{0}&\mel*{1}{\hat{H}}{1}]\tag{7}$$
然后只要将哈密顿量的函数形式代入 (7) 中计算, 得到 $2 \times 2$ 的厄米矩阵. 再进行对角化就可以得到本征值和本征态.

一个 spin $1/2$ 系的哈密顿量的一般形式为
$$\hat{H} = a \hat{S}^x + b\hat{S}^y + c \hat{S}^z + d\mathbb{1}\tag{8}$$
$a,b,c,d$ 为任意实数. 在将其代入方程（7）之前，让我们先考虑自旋的[[升降算符]] $\hat{S}^{\pm}$

```ad-note
title: 升降算符
$$
\hat{S}^{\pm} \equiv \hat{S}^x \pm \mi \hat{S}^y\tag{9}
$$

$$
\hat{S}^x = \frac12(\hat{S}^+ + \hat{S}^-)
, \quad \hat{S}^y = \frac{1}{2 \mi}(\hat{S}^+ - \hat{S}^-)
$$
```

$$
\hat{S}^+\ket{0}=0,\ \hat{S}^+\ket{1}=\ket{0}
,\ \hat{S}^-\ket{0} = \ket{1},\ \hat{S}^- \ket{1} = 0\tag{10}
$$

代入 (7) 中计算可以得到
$$
\begin{align}
\ev*{H}{0} &= \ev*{aS^x +bS^y + cS^z + d \mathbb{1}}{0}\\
&= \bra{0} \qty(\frac{a}{2}\ket{1} - \frac{b}{2\mi}\ket{1} + \frac{c}{2} \ket{0} + d \ket{0})\\
&= \frac{c}{2}+d
\end{align}
$$
于是, 哈密顿量写成矩阵形式
$$
H=\mqty[
\dfrac{c}{2}+d & \dfrac{a}{2} - \mi \dfrac{b}{2}\\
\dfrac{a}{2} + \mi \dfrac{b}{2}&-\dfrac{c}{2}+d
]\tag{11}
$$

#### 1.3.1.2. 二自旋体系

接下来考虑两个不同位置各自带一个自旋 $1/2$ 的系统。此时，希尔伯特空间的维度为 $2^2 = 4$. 

也就是说，需要准备 4 个独立的向量。在许多情况下，我们可以用以下方式标记这些向量：
$$
\ket{0_1} \otimes \ket{0_2}
,\ \ket{0_1} \otimes \ket{1_2}
,\ \ket{1_1} \otimes \ket{0_2}
,\ \ket{1_1} \otimes \ket{1_2}\tag{12}
$$
此时的 $\ket{0_i}, \ket{1_i}$ 是算符 $\hat{S}_i^z$ 的本征态. 简记作
$$
\ket{00}, \ket{01}, \ket{10}, \ket{11}\tag{13}
$$

像在第 [[#1.2. 矩阵表示|1.2]] 章中，我们将向量 $\vb*{n}$ 与其对应的表达式关联起来，它们分别是 $\vb*{n} = (0, 0), (0, 1), (1, 0), (1, 1)$. 接下来，我们需要使用这 4 个向量来计算 $4 \times 4 = 16$ 个矩阵元. 

然而，在程序中，我们遇到一个问题，即如何对这些向量进行编号。这是因为在程序中，矩阵通常被存储为二维数组，其索引是整数。

我们可以通过使用二进制数的 2 位数来解决这个问题。二进制的2位数与十进制数之间有以下关系
$$
\begin{align}
00 \leftrightarrow 0_{10}\tag{14}\\
01 \leftrightarrow 1_{10}\tag{15}\\
10 \leftrightarrow 2_{10}\tag{16}\\
11 \leftrightarrow 3_{10}\tag{17}
\end{align}
$$

在这里，下标 $10$ 表示以十进制表示的数，强调了对 $\vb*{n}$ 进行编号，这样我们就能够将矩阵表示的哈密顿算符存储在程序中。在 C 语言或 Python 中，数组的索引从 0 开始，因此可以直接使用上面的对应关系。

而在 Fortran 或 Julia 中，数组的索引从 1 开始，因此可以使用将上面等式右侧加 1 的形式。

具体来说
```ad-example
title: 横场 Ising 模型
$$
\begin{align}
\hat{H} &= J \hat{S}_1^z \hat{S}_2^z - h(\hat{S}_1^x + \hat{S}_2^x)\\
&= J \hat{S}_1^z \hat{S}_2^z - \frac{h}{2}
\qty(\hat{S}_1^++\hat{S}_1^-+\hat{S}_2^++\hat{S}_2^-)
\end{align}\tag{18}
$$
$$
\ev*{H}{00} = \frac{J}{4}, \cdots
$$
矩阵形式
$$
H=\mqty[
J/4 & -h/2 & -h/2 & 0\\
-h/2 & -J/4 & 0 & -h/2\\
-h/2 & 0 & -J/4 & -h/2\\
0 & -h/2 & -h/2 & J/4
]\tag{19}
$$
```

^5ab191


```ad-example
title: XXY 模型
$$
\begin{align}
\hat{H} &= J(\hat{S}_1^x \hat{S}_2^x + \hat{S}_1^y \hat{S}_2^y + \Delta \hat{S}_1^z \hat{S}_2^z)\\
&= J \qty[\frac12 \qty(\hat{S}_1^+ \hat{S}_2^- + \hat{S}_1^-\hat{S}_2^+)+\Delta \hat{S}_1^z \hat{S}_2^z]
\end{align}\tag{20}
$$
$$
H = \mqty[
J \Delta/4 & 0 & 0 & 0\\
0 & -J\Delta / 4 & J/2 & 0\\
0 & J/2 & -J\Delta/4 & 0\\
0 & 0& 0 & J\Delta /4
]\tag{21}
$$

```

^ce5fb8

#### 1.3.1.3. 多自旋体系

将上述内容进行一般化，考虑一个由 $M$ 个自旋 $1/2$ 粒子组成的系统，每个粒子位于不同的位置上。这时候系统的希尔伯特空间维度为 $D = 2^M$. 在这种情况下，状态可以用一个 $M$ 维的向量 $n \equiv (n_1, n_2, \cdots, n_M)$ 来表示，其中 $n_i= 0,1$. 

在程序中需要生成这样的 $2^M$ 个数列。在这种情况下，如果能够有从十进制数到二进制数的转换程序以及其逆过程就可以了。

在进行矩阵元的计算时, 以下的定义是有益的
$$
\begin{align}
\hat{S}_j^+ \ket{\vb*{n}} &= \ket{\vb*{n} - \vu*{e}_j}\tag{22}\\
\hat{S}_j^- \ket{\vb*{n}} &= \ket{\vb*{n} + \vu*{e}_j}\tag{23}\\
\bra{\vb*{n}} \hat{S}_j^+ &= \bra{\vb*{n} + \vu*{e}_j}\tag{24}\\
\bra{\vb*{n}} \hat{S}_j^- &= \bra{\vb*{n} - \vu*{e}_j}\tag{25}\\
\hat{S}_j^z \ket{\vb*{n}} &= \frac{(-1)^{n_j}}{2} \ket{\vb*{n}}\tag{26}\\
\bra{\vb*{n}} \hat{S}_j^z &= \frac{(-1)^{n_j}}{2} \bra{\vb*{n}}\tag{27}
\end{align}
$$

其中 $\vu*{e}_j = (0,0,\cdots, 0, 1, 0, \cdots, 0)$, 是第 $j$ 分量方向的单位矢量.

### 1.3.2. 硬核玻色体系

在这里，我们考虑*硬核玻色子系统*。

硬核玻色子系统是一种具有特定约束条件的玻色子系统，即在某个位置上最多占有一个玻色子。如果我们用 $\hat{a}_j$ 表示位置 $j$ 处的玻色湮灭算符，那么这个约束条件可以写成 $\hat{a}_j^2 = 0$，以及 $\hat{a}_j^2 = 0$. 

因为每个位置上只能有 0 个或者 1 个玻色子，所以该位置的希尔伯特空间可以由 $\ket{0}_j$ 和 $\ket{1}_j$ 这两个态张成。这里的 0 和 1 表示玻色子的占有数。

这种情况与自旋 $1/2$ 的系统是完全相同的。实际上，可以证明玻色子算符和自旋 $1/2$ 之间存在以下对应关系：
$$
\hat{a}_j = \hat{S}_j^+,\quad
\hat{a}_j^\dagger = \hat{S}_j^-,\quad
\hat{n}_j = \frac12 - \hat{S}_j^z\tag{28}
$$

通过这样定义硬核玻色子的算符，玻色子的交换关系成立，并且约束条件也得到再现。

在前一章的 [[#1.3.1. $1/2$ 自旋体系|1.3.1]] 中，我们将 $\ket{\uparrow}$ 写成 $\ket{0}$，$\ket{\downarrow}$ 写成 $\ket{1}$，也是为了与硬核玻色子体系进行对应。因此，数值计算方法完全相同，因此不再进一步解释。

最后，让我们看一下硬核玻色子系统的典型哈密顿量。以下是一个示例的哈密顿量：

```ad-example
title: 自旋 $1/2$ XY 模型:
$$
\begin{align}
H &= -J \sum_j \qty(\hat{S}_j^x \hat{S}_{j+1}^x + \hat{S}_j^y \hat{S}_{j+1}^y)\\
&= -\frac{J}{2} \sum_j \qty(
\hat{S}_j^ + \hat{S}_{j+1}^- + \hat{S}_j^- \hat{S}_{j+1}^+
)
\end{align}\tag{29}
$$
```

利用 (28) 的对应关系转换成*硬核玻色体系*
$$
H = -\frac{J}{2} \sum_j
\qty(
\hat{a}_{j+1}^\dagger \hat{a}_j
+ \hat{a}_j^\dagger \hat{a}_{j+1}
)\tag{30}
$$
这实际上就是*无相互作用*的硬核 Bose-Hubbard 模型.


### 1.3.3. Higher spin 体系

在这里，考虑 $S > 1/2$ 的高自旋系统。以 $S = 1$ 的量子自旋系统为例. 在这种情况下，局部希尔伯特空间以 $\hat{S}_j^z$ 的本征态为基，由 $\ket{S_z = +1}$, $\ket{S_z = 0}$, $\ket{S_z= -1}$ 这三个态张成. 

令 $\ket{0} \equiv \ket{S_z = +1}$, $\ket{1} \equiv \ket{S_z = 0}$, $\ket{2} \equiv \ket{S_z = -1}$.

因此，$M$ 个自旋 $1$ 的系统的基, 可以用 $M$ 位三进制表示.

例如，当有两个自旋 1 的粒子时，整个希尔伯特空间由以下 9 个状态组成：
$$
\begin{align}
00 \leftrightarrow 0_{10}, \quad 01 \leftrightarrow 1_{10}, \quad 02 \leftrightarrow 2_{10},\tag{31}\\
10 \leftrightarrow 3_{10}, \quad 11 \leftrightarrow 4_{10}, \quad 12 \leftrightarrow 5_{10},\tag{32}\\
20 \leftrightarrow 6_{10}, \quad 21 \leftrightarrow 7_{10}, \quad 22 \leftrightarrow 8_{10},\tag{33}
\end{align}
$$
关于从十进制到三进制的转换，你可以使用二进制的程序，只需将其中的 2 替换为 3 即可。

```ad-warning
从理论上讲，上述方法是没有问题的。然而，在处理像高自旋系统这样的大状态数的情况时，当将 $M$ 位的三进制转换为十进制时，需要注意十进制表示的数可能会变得非常大，可能会引发溢出的风险。
```


### 1.3.4. $U(1)$ 对称体系

在这里，考虑哈密顿量具有某种对称性的情况。正如下面所述的，当存在对称性时，哈密顿量可以进行分块对角化。每个块的大小都小于原矩阵的大小，并且可以独立地对每个块进行对角化计算，因此从计算复杂性的角度来看，这是非常重要的。

例如，假设全希尔伯特空间的维数为 $D$，并且它分为两个大小为 $D/2 \times D/2$ 的块。数值对角化的计算复杂性通常被认为是矩阵大小的三次方阶。因此，在不使用对称性的情况下，计算复杂性为 $\order{D^3}$. 

另一方面，如果针对每个块进行对角化，计算复杂性为 $2 \times (D/2)^3= D^3/4$，计算时间大约减少了四分之一。

如果块被分得更小，那么计算时间的削减可能会更大。因此，在存在对称性的情况下，积极利用对称性是一个好主意.

```ad-note
*当系统具有对称性时，意味着存在某个幺正算符* $\hat{U}$，使得它与哈密顿量对易 
$$\comm*{\hat{U}}{\hat{H}}=0$$
```

对称性有许多不同种类，要理解它们，需要学习群论等内容。在这里，我们考虑在物理上经常出现且可以大大减少计算量的 $U(1)$ 对称性的情况。

首先考虑自旋系统的例子。作为幺正算符的一个例子，可以选择：
$$
\hat{U}(\theta) \equiv \me^{-\mi \hat{S}_{\text{tot}}^z\theta}\tag{34}
$$

其中，$\hat{S}^z_{\text{tot}} \equiv \sum_{j=1}^M \hat{S}^z_j$，$θ$ 为任意实数。

在这种情况下，如果 $\comm*{\hat{S}_{\text{tot}}^z}{\hat{H}}=0$，则可以得出 $\comm*{\hat{U}(\theta)}{\hat{H}}=0$（通过进行Taylor展开来证明）。

因此，我们考虑 $\comm*{\hat{S}_{\text{tot}}^z}{\hat{H}}=0$ 的情况。根据线性代数定理，$\hat{S}_{\text{tot}}^z$ 和 $\hat{H}$ 是可以同时对角化的。因此，可以通过 $\hat{S}_{\text{tot}}^z$ 的特征值将 $\hat{H}$ 分块对角化。作为与 $\hat{S}_{\text{tot}}^z$ 可交换的哈密顿量，我们可以考虑 XXZ 模型：
$$
\begin{align}
\hat{H} &= J \sum_j \qty(\hat{S}_j^x \hat{S}_{j+1}^x + \hat{S}_j^y \hat{S}_{j+1}^y + \Delta \hat{S}_j^z \hat{S}_{j+1}^z)\\
&= J \sum_j \qty[\frac12 \qty(\hat{S}_j^+ \hat{S}_{j+1}^- + \hat{S}_{j}^-\hat{S}_{j+1}^+)+\Delta \hat{S}_{j}^z \hat{S}_{j+1}^z]
\end{align}\tag{20}
$$

实际上，对于两个 sites 的情况，如 ([[#^ce5fb8|21]]) 所示，系统会呈现出块对角的形式。在这种情况下，左上方的块对应于 $\hat{S}_{\text{tot}}^z=1$，中间的块对应于 $\hat{S}_{\text{tot}}^z=0$，右下方的块对应于 $\hat{S}_{\text{tot}}^z=-1$. 

对于自旋系统，是否存在 $U(1)$ 对称性可以通过观察 $\hat{S}^+$ 和 $\hat{S}^-$ 的数量来判断。首先，由于$\hat{S}_{j}^z$ 与$\hat{S}_{\text{tot}}^z$ 是可交换的，它们显然具有 $U(1)$ 对称性。

对于其他具有相同数量的 $\hat{S}_j^\pm$ 项的情况，如果这些项在哈密顿量中作用时不改变 $\hat{S}_{\text{tot}}^z$ 的值，那么 $\hat{S}_{\text{tot}}^z$ 会保持不变，从而保持 $U(1)$ 对称性。因此，系统将具有 $U(1)$ 对称性。

类似地，像 ([[#^5ab191|18]]) 式中的横向磁场伊辛模型中的横向磁场项只包含 $\hat{S}^±_j$，因此它不具有 $U(1)$ 对称性。


接下来考虑 Hubbard 模型。这里的 $\hat{a}_j$ 代表常规玻色粒子的湮灭算符。在这里，以 Bose-Hubbard 模型为例进行解释

$$\hat{H} = -J\sum_j \qty(\hat{a}_{j+1}^\dagger \hat{a}_j + \hat{a}_{j}^\dagger \hat{a}_{j+1})
+\frac{U}{2} \sum_j \hat{n}_j(\hat{n}_j-1)\tag{36}$$

这个模型是与全粒子数算符 $\hat{N} \equiv \sum_{j=1}^M \hat{n}_j$ 可交换的。因此，可证明与哈密顿算符可交换的幺正算符 $\hat{U}(\theta) = \me^{-\mi \hat{N} \theta}$ 与哈密顿算符具有可交换性，从而具备 $U(1)$ 对称性。

在这种情况下，判断是否存在 $U(1)$ 对称性也很简单，只需观察 $\hat{a}^\dagger$ 的数目与 $\hat{a}$ 的数目在所有项中是否相等，因为这将保持粒子数不变，从而具备 $U(1)$ 对称性。

接下来，我们考虑考虑 $U(1)$ 对称性进行数值计算的方法。在这里，我们考虑自旋 $1/2$ 的系统。虽然直接考虑 $\hat{S}_{\text{tot}}^z$ 也是可以的，但是由于它可以取正负两种值，可能会比较麻烦。正如第 [[#1.3.2. 硬核玻色体系|1.3.2]] 章所示，自旋 $1/2$ 的系统与硬核玻色子系统等效. 硬核玻色子的粒子数算符与 $\hat{N}_{\text{HB}} = \sum_j \hat{a}^\dagger_j \hat{a}_j = \sum_j (1/2 - \hat{S}_j^z)$ 有关。因此，我们在这里考虑后者。

为了考虑 $U(1)$ 对称性，首先从未考虑 $U(1)$ 对称性时求得的基态 $\ket{\vb*{n}}$ 中挑选出其中本征值等于所需粒子数 $N$ 的基态。
然后，将挑选出的基态（记作 $\ket{\vb*{n},N}$ ）按照十进制表示进行排序，以便重新编号为 $1, 2, \cdots, D_N$（其中 $D_N$ 是粒子数为 $N$ 的子空间的维数）。

在这种情况下，需要注意的是，基态 $\ket{\vb*{n}}$ 的十进制表示可能与向量索引的编号不匹配。例如，将算符 $\hat{M}$ 作用在 $\ket{\vb*{n}}$ 上得到 $\hat{M} \ket{\vb*{n}} = \ket{\vb*{m}}$。
我们需要知道 $\ket{\vb*{m}}$ 对应的向量索引是什么。通过将 $\ket{\vb*{n},N}$ 按照从小到大的顺序存储在内存中，可以在通过二分搜索高效地找到对应的索引。具体的代码将在 [[#1.3.6. 软核玻色子体系|1.3.6]] 中给出。
### 1.3.5. $Z(2)$ 对称体系

在这里，我们考虑最简单的离散对称性之一，即 $Z_2$ 对称性的情况下的对角化。与 $U(1)$ 对称性的情况不同，这种情况下的编码通常会变得更加复杂。请参考文献[[量子热化的精确对角化指南|]][^4]以获取更多信息。

$Z_2$ 对称性通常是指, 与哈密顿算符对易的幺正算符满足 $\hat{U}^2 = \mathbb{1}$ 时的情况。换句话说，应用两次变换后会回到原始状态。具体的例子包括空间反演和自旋翻转操作。

由于 $\hat{U}^2 = \mathbb{1}$，因此 $\hat{U}$ 的特征值只能是 $+1$ 或 $-1$。因此，当系统具有 $Z_2$ 对称性时，希尔伯特空间会根据 $\hat{U}$ 的特征值 $±1$ 被分解成两个子空间的直和。这两个子空间分别被称为*偶宇称子空间*（ $+1$ 的部分）和*奇宇称子空间*（ $-1$ 的部分）。

在这里，引入一些概念。为了简化，我们考虑没有 $Z_2$ 对称性之外的其他对称性的情况，即考虑一个只有 $Z_2$ 对称性的哈密顿算符。我们使用基底 $\ket{\vb*{n}}$. 这里，我们定义一个*等价类*（equivalent class，EC）。

等价类指的是, 对各个基底 $\ket{\vb*{n}}$, 由 (37) 定义的集合.
$$
\text{EC}(\vb*{n}) = \qty{\vb*{n}, \hat{U} \ket{\vb*{n}}}\tag{37}
$$
在这种情况下，由于存在 $Z_2$ 对称性，同等类的元素数量为 1 或 2. 对于每个等价类，可以通过以下方式定义*代表元*（representative state，RS）：
$$
\begin{align}
\bar{\vb*{n}} &\equiv \min_l [U^l(\vb*{n})]\tag{38}\\
\hat{U} \ket{\vb*{n}} &\equiv \ket{U(\vb*{n})}\tag{39}
\end{align}
$$

在这里，$\min_l$ 表示当按照自己规定的规则对 $U^l(\vb*{n})$ 进行编号时，$\min_l$ 是最小的编号。另外，$q(\bar{\vb*{n}})$ 被定义为代表元 $\ket{\bar{\vb*{n}}}$ 所属的等价类的元素数量。

为了理解这些，我们考虑一个由 4 个自旋 $1/2$ 系统组成的情况。基底记作 $\ket{\vb*{n}} = \ket{n_1,n_2,n_3,n_4}$，其中 $n_i = 0, 1$. 

另外，我们考虑了空间反转操作的定义
$$
\hat{U}\ket{n_1,n_2,n_3,n_4} = \ket{n_4,n_3,n_2,n_1}\tag{40}
$$
考虑到 Hilbert 空间的维度为 16，因此基底、等价类（EC）、代表元（RS）和等价类元素数可以表示如表所示。

在这种情况下，当状态 $\ket{\vb*{n}}$ 为 $\hat{U}$ 的本征态时，等价类的元素数量为 $1$, 否则为 $2$.

|index|基底 $\ket{\vb*{n}}$|EC 等价类|RS 代表元 $\ket{\bar{\vb*{n}}}$|$q(\bar{\vb*{n}})$|
|:-:|:-:|:-:|:-:|:-:|
|1|$\ket{0000}$|$\qty{\ket{0000}}$|$\ket{0000}=\ket{1}$|$1$|
|2|$\ket{0001}$|$\qty{\ket{0001},\ket{1000}}$|$\ket{0001}=\ket{2}$|2|
|3|$\ket{0010}$|$\qty{\ket{0010},\ket{0100}}$|$\ket{0010}=\ket{3}$|2|
|4|$\ket{0011}$|$\qty{\ket{0011},\ket{1100}}$|$\ket{0011}=\ket{4}$|2|
|5|$\ket{0100}$|$\qty{\ket{0100},\ket{0010}}$|$\ket{0010}=\ket{3}$|2|
|6|$\ket{0101}$|$\qty{\ket{0101},\ket{1010}}$|$\ket{0101}=\ket{6}$|2|
|7|$\ket{0110}$|$\qty{\ket{0110}}$|$\ket{0110}=\ket{7}$|1|
|8|$\ket{0111}$|$\qty{\ket{0111},\ket{1110}}$|$\ket{0111}=\ket{8}$|2|
|9|$\ket{1000}$|$\qty{\ket{1000},\ket{0001}}$|$\ket{0001}=\ket{2}$|2|
|10|$\ket{1001}$|$\qty{\ket{1001}}$|$\ket{1001}=\ket{10}$|1|
|11|$\ket{1010}$|$\qty{\ket{1010},\ket{0101}}$|$\ket{0101}=\ket{6}$|2|
|12|$\ket{1011}$|$\qty{\ket{1011},\ket{1101}}$|$\ket{1011}=\ket{12}$|2|
|13|$\ket{1100}$|$\qty{\ket{1100},\ket{0011}}$|$\ket{0011}=\ket{4}$|2|
|14|$\ket{1101}$|$\qty{\ket{1101},\ket{1011}}$|$\ket{1011}=\ket{12}$|2|
|15|$\ket{1110}$|$\qty{\ket{1110},\ket{0111}}$|$\ket{0111}=\ket{8}$|2|
|16|$\ket{1111}$|$\qty{\ket{1111}}$|$\ket{1111}=\ket{16}$|1|


利用等价类，可以构建出使得 $\hat{U}$ 成为特征算符的基底

$$
\ket{\bar{\vb*{n}},p} \equiv \frac{\sqrt{q(\bar{\vb*{n}})}}{2}
\qty(\ket{\bar{\vb*{n}}}+p \hat{U} \ket{\bar{\vb*{n}}})\tag{41}
$$
在这里，$p$ 代表了矩阵 $\hat{U}$ 的特征值，可以取 $\pm 1$. 很容易可以验证这是矩阵 $\hat{U}$ 的本征态

$$
\begin{align}
\hat{U} \ket{\bar{\vb*{n}},p} &= 
\frac{\sqrt{q(\bar{\vb*{n}})}}{2}
\qty(\hat{U} \ket{\bar{\vb*{n}}} + p \hat{U}^2\ket{\bar{\vb*{n}}})\\
&= \frac{\sqrt{q(\bar{\vb*{n}})}}{2} \qty(\hat{U} \ket{\bar{\vb*{n}}}+ p \ket{\bar{\vb*{n}}})\\
&=p\ket{\bar{\vb*{n}},p}
\end{align}\tag{42}
$$

使用 $Z_2$ 对称性进行严格对角化时，将使用这个基 $\ket{\bar{\vb*{n}},p}$ 来计算哈密顿算符的矩阵元。在这种情况下，由于 $p$ 可以取 $±1$，因此可以进行直和分解，通过针对每个本征值进行对角化来获得所有本征值和本征矢.

用考虑了对称性的基, 来计算矩阵元。在进一步讨论之前，让我们先看一下状态矢的展开方式。

假设状态矢为 $\ket{\psi}$，并且我们假设它属于本征值 $p$ 的 sector. 在这种情况下，态矢可以表示为
$$
\ket{\psi} = \sum_{\overline{\vb*{m}}}\ket{\bar{\vb*{m}},p} \ip{\bar{\vb*{m}},p}{\psi}\tag{43}
$$

在物理量的计算中，有时候使用 $\ket{\vb*{n}}$ 基底而不是 $\ket{\bar{\vb*{n}},p}$ 会更方便。因此，我们需要研究这两种基底之间的变换规则。

内积 $\ip{\vb*{n}}{\bar{\vb*{m}},p}$ 为
$$
\begin{align}
\ip{\vb*{n}}{\bar{\vb*{m}},p}&=\frac{\sqrt{q(\bar{\vb*{m}})}}{2}
\qty(\ip{\vb*{n}}{\bar{\vb*{m}}} + p \mel*{\vb*{n}}{\hat{U}}{\bar{\vb*{m}}})\\
&= \begin{cases}
\frac{\sqrt{q(\bar{\vb*{m}})}}{2}[\delta_{\vb*{n},\bar{\vb*{m}}}+ p \delta_{P(\vb*{n}),\bar{\vb*{m}}}], \quad &\vb*{n} \in \text{EC}(\bar{\vb*{m}})\\
0, &\text{otherwise}
\end{cases}
\end{align}\tag{44}
$$
```ad-check
作为验证
$$
\begin{align}
\ip{0100}{0010,-1}&=\frac{\sqrt{2}}{2}(0-1) = -\frac{\sqrt{2}}{2}\\
\ip{0010}{0010,-1}&=\frac{\sqrt{2}}{2}(1-0)=\frac{\sqrt{2}}{2}\\
\ip{1111}{1111,1} &= \frac12 (1+1)=1\\
\ip{0000}{0000,1} &= \frac12 (1+1)=1\\
\ip{0000}{0001,-1} &= \frac{\sqrt{2}}{2} (0 - 0) = 0
\end{align}
$$
符合 (44) 的结论.
```

由此, 态矢

$$
\begin{align}
\ip{\vb*{n}}{\psi} &= \bra{\vb*{n}}\sum_{\bar{\vb*{m}}}\ket{\bar{\vb*{m}},p}\ip{\bar{\vb*{m}},p}{\psi}\\
&= \sum_{\bar{\vb*{m}}} \ip{\vb*{n}}{\bar{\vb*{m}},p}\ip{\bar{\vb*{m}},p}{\psi}
\end{align}
$$
```ad-note
如上文所述, 我们将属于 $p$ sector 的态矢 $\ket{\psi}$ 使用同为 $p$ 的基底展开. 
```
由 (44) 可知, 如果 $\vb*{n} \in \text{EC}(\bar{\vb*{m}})$, 则
$$
\ip{\vb*{n}}{\psi}
= \sum_{\bar{\vb*{m}}} \frac{\sqrt{q(\bar{\vb*{m}})}}{2}[\delta_{\vb*{n},\bar{\vb*{m}}}
+ p \delta_{P(\vb*{n}),\bar{\vb*{m}}}]\ip{\bar{\vb*{m}},p}{\psi}
$$
而如果 $\vb*{n}$ 不属于 $\bar{\vb*{m}}$ 的等价类, 则直接为 0. 所以*大前提*是, $\ket{\vb*{n}}$ 与 $\ket{\psi}$ 属于同一个 sector.

接下来继续计算 $\ip{\vb*{n}}{\psi}$, 

1. 首先考虑 $p=1$. 则此时 $\ket{\psi}$ 属于 $\ket{0000}, \ket{1111}, \ket{1001}, \ket{0110}$ 的 sector. 
并且 $\vb*{n} = P(\vb*{n})$. 即 $\vb*{n}$ 也属于同一个 sector. 此时的等价类元素数均为 1, 由此
$$
\begin{align}
\ip{\vb*{n}}{\psi} &= \frac12 (\ip{\vb*{n},1}{\psi} + \ip{\vb*{n},1}{\psi})\\
&= \ip{\vb*{n},1}{\psi} = \ip{\bar{\vb*{n}},p}{\psi}
\end{align}
$$
2. 然后是 $p=-1$. 而 $\vb*{n} = P(\vb*{n})$ 仍然成立. 显然 $\ket{\vb*{n}}, \ket{\psi}$ 属于不同的 sector. 由 (44) 可知
$$
\ip{\vb*{n}}{\psi}=0
$$
3. $\vb*{n} \neq P(\vb*{n})$, 即 $\vb*{n}$ 不属于上述四个空间反演对称的态. 而同时 $\vb*{n} = \bar{\vb*{n}}$, 即它是一个等价类中, 编号较小的那个. 例如 $\ket{\vb*{n}} = \ket{0001}$.
考虑 $\ket{\psi}$ 属于同一个 sector. 此处隐含了 $p=-1$ 这个条件.
$$
\begin{align}
\ip{\vb*{n}}{\psi} &= \sum_{\bar{\vb*{m}}} \frac{1}{\sqrt{2}}
[\delta_{\vb*{n},\bar{\vb*{m}}}-\delta_{P(\vb*{n}),\bar{\vb*{m}}}]
\ip{\bar{\vb*{m}},p}{\psi}
\end{align}
$$
显然, 空间反演后的 $P(\vb*{n})$ 不可能等于代表元. $\delta_{P(\vb*{n}),\bar{\vb*{m}}}=0$.
$$
\ip{\vb*{n}}{\psi} = \frac{1}{\sqrt{2}} \ip{\vb*{n},p}{\psi}
= \frac{1}{\sqrt{2}} \ip{\bar{\vb*{n}},p}{\psi}
$$
4. 最后 $\vb*{n} \neq P(\vb*{n})$, 且 $\vb*{n} \neq \bar{\vb*{n}}$. 例如, $\ket{\vb*{n}} = \ket{1000}$.
$$
\begin{align}
\ip{\vb*{n}}{\psi} &= \sum_{\bar{\vb*{m}}}\frac{1}{\sqrt{2}}
[\delta_{\vb*{n},\bar{\vb*{m}}}-\delta_{P(\vb*{n}),\bar{\vb*{m}}}]
\ip{\bar{\vb*{m}},p}{\psi}
\end{align}
$$
显然 $\delta_{\vb*{n},\bar{\vb*{m}}}=0$
$$
\begin{align}
\ip{\vb*{n}}{\psi} &= \sum_{\bar{\vb*{m}}}\frac{1}{\sqrt{2}}
[-\delta_{P(\vb*{n}),\bar{\vb*{m}}}]
\ip{\bar{\vb*{m}},p}{\psi}\\
&= \frac{p}{\sqrt{2}} \ip{P(\vb*{n}),p}{\psi}\\
&= \frac{p}{\sqrt{2}} \ip{\bar{\vb*{n}},p}{\psi}
\end{align}
$$
综合上述四种情况

$$
\begin{align}
\ip{\vb*{n}}{\psi} = \begin{cases}
\ip{\bar{\vb*{n}},p}{\psi}, \quad& \vb*{n} = P(\vb*{n}),\ p=1\\
0,& \vb*{n}=P(\vb*{n}),\ p=-1\\
\frac{1}{\sqrt{2}} \ip{\bar{\vb*{n}},p}{\psi},&\vb*{n}\neq P(\vb*{n}),\ \vb*{n}=\bar{\vb*{n}}\\
\frac{p}{\sqrt{2}}\ip{\bar{\vb*{n}},p}{\psi}, &\vb*{n}\neq P(\vb*{n}),\ \vb*{n} \neq \bar{\vb*{n}}
\end{cases}
\end{align}\tag{45}
$$

根据上述结果，可以计算哈密顿算符的矩阵元。为了得到这个结果，可以使用以下的关系式
$$
\begin{align}
\bra{\bar{\vb*{n}},p}\hat{H} &= \frac{\sqrt{q(\bar{\vb*{n}})}}{2}
\qty(\bra{\bar{\vb*{n}}}+p \hat{U} \bra{\bar{\vb*{n}}})\hat{H}\\
&=
\end{align}
$$


### 1.3.6. 软核玻色子体系

### 1.3.7. 无自旋费米子系

## 1.4. 方法二: 张量积法

$$
\hat{S}_i
$$

## 1.5. 纠缠熵

这段文字主要讨论了纠缠熵的计算方法。纠缠熵是指示纯态 $\ket{\psi}$ 与直积态有多大差距的指标。直积态指的是类似于经典对应物的状态，因此，状态不是直积态意味着系统是“量子的”。除此之外，还有许多应用，但需要参考量子力学和量子信息的专业书籍。

首先，给出了纠缠熵的定义。将给定的量子系统分成部分系统 A 和部分系统 B。例如，在一维系统中，典型的情况是将系统的左侧设为 A，右侧设为 B。下文中，将全系统的计算基底记为 $\vb*{n}$，部分系统的计算基底分别记为 $\vb*{n}_A$ 和 $\vb*{n}_B$. 例如，当 $\vb*{n} = (0, 1, 1, 0)$ 时，假设系统在中心被分割，部分系统的状态可以写作 $\vb*{n}_A = (0, 1)$、$\vb*{n}_B = (1, 0)$。这里假定全系统处于纯态。密度矩阵算子是
$$
\hat{\rho} \equiv \op{\psi}
$$
在这里，约化密度矩阵（reduced density matrix）是

$$
\begin{align}
\hat{\rho}_A &= \Tr_B \hat{\rho} = \sum_{\vb*{n}_B}
\mel*{\vb*{n}_B}{\hat{\rho}}{\vb*{n}_B}\\
\hat{\rho}_B &= \Tr_A \hat{\rho} = \sum_{\vb*{n}_A}
\mel*{\vb*{n}_A}{\hat{\rho}}{\vb*{n}_A}
\end{align}
$$
在这里，$\Tr_A$ 和 $\Tr_B$ 代表对部分系统 A 和 B 进行的*部分迹*（partial trace）。纠缠熵是使用这个缩减密度矩阵来衡量的。

$$
S_{\text{vN}} \equiv -\Tr_A (\rho_A \ln \rho_A)=-\Tr_B (\rho_B \ln \rho_B)
$$
$S_{\text{vN}}$ 或称为冯·诺依曼（von Neumann）纠缠熵。对于部分系统A的纠缠熵和部分系统B的纠缠熵是相等的，这将在稍后展示。另外，还有另一种称为 Rényi 纠缠熵的纠缠熵，其定义如下：

$$S^{(n)} \equiv \frac{1}{1-n} \ln[\Tr_A(\hat{\rho}_A^n)]
,\quad n = 2,3,\cdots$$
$n=2$ 时被称为二次 Rényi 熵，它已经在实验中观测到 [8]，也经常在理论上进行计算（冯·诺伊曼熵尚未在实验中观测到）。

要数值计算纠缠熵，需要数值计算缩减密度矩阵，并根据上述定义进行计算。但是，由于定义中包含 $\ln \hat{\rho}_A$，因此需要计算缩减密度矩阵的矩阵表示，然后执行对角化来评估对数部分，这需要一些手动操作。这里使用奇异值分解（Singular Value Decomposition, SVD）作为另一种方法 [6, 7]。首先介绍一下SVD的定义。SVD 是针对任意的 N × M 复数矩阵 A 的操作。换句话说，矩阵 A 总是可以被改写成以下形式：


---

# 2. 稀疏矩阵

一般来说，量子多体系统的希尔伯特空间维数随系统大小呈指数增长。由于哈密顿算符总共有 $D \times D$ 个元素，如果要存储所有这些元素，就会需要大量的内存。假设用双精度复数来表示哈密顿算符的矩阵元，那么存储哈密顿算符所需的内存量可以通过以下方式计算：
$$
2\times8 \times D^2 \times 10^{-9} \text{GB}\tag{70}
$$

举个例子，假设 $D = 2^{16} = 65536$，大约需要约 $70$ GB 的内存。如果要计算全部特征值和特征向量，则需要大约这个内存的两倍。然而，一般来说，量子多体系统的哈密顿算符在矩阵表示中大部分元素都是零。这种矩阵被称为稀疏矩阵。通过只存储非零元素，可以节省内存空间。

稀疏矩阵的存储方法有多种形式，这里我将解释 COO (coordinate) 格式和 CRS (compressed row storage) 格式。以矩阵 $A$ 为具体例
$$
A=\mqty[1&0&3&0&2\\
0&1&0&4&6\\
2&5&3&0&0\\
0&0&7&8&0\\
0&1&0&3&9]\tag{71}
$$
在这种情况下，矩阵中有 14 个非零元素。COO 形式使用了 3 个数组来表示这个矩阵。以下是具体的数字和数组表示：

```
val(1:14) = (1, 3, 2, 1, 4, 6, 2, 5, 3, 7, 8, 1, 3, 9)
row(1:14) = (1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 5, 5, 5)
col(1:14) = (1, 3, 5, 2, 4, 5, 1, 2, 3, 3, 4, 2, 4, 5)
```

数组 `val` 中按从左到右、从上到下的顺序存储了非零元素。数组 `col` 和 `row` 分别存储了 `val` 中非零元素的行索引和列索引。

在 CRS 形式中，`val` 和 `col` 与 COO 形式中的相同，但是使用了 `row_ptr` 代替了 `row`。观察数组 `row`，可以看到相同的数字在连续出现。因此，将行的变化点的索引值存储在 `row_ptr` 中，就能唯一地表示矩阵。具体示例如下：

```
val(1:14) = (1, 3, 2, 1, 4, 6, 2, 5, 3, 7, 8, 1, 3, 9)
col(1:14) = (1, 3, 5, 2, 4, 5, 1, 2, 3, 3, 4, 2, 4, 5)
row_ptr(1:6) = (1, 4, 7, 10, 12, 14+1)
```

例如，如果 `row_ptr(2)=4`，这意味着在 `val` 数组中，第 4 个元素是第 2 行的第一个非零元素。最后一个元素是非零元素的数量加 1。这就是 CRS 格式。

在编码时有一个值得注意的点。上面的示例介绍了在将矩阵 $A$ 存储在内存中的情况下的伪代码。

然而，正如最初所述，将量子多体系统的哈密顿算符存储在内存中通常是不可能的。因此，上面的伪代码实际上是不完整的。实际上，您可以在使用矩阵 $A$ 的地方准备一个子例程，用于返回 $A$ 的第 $i$ 行的非零元素，并在需要时调用它。

---

# 3. 时间演化

在这一章中，我们将考虑求解时间相关的薛定谔方程。所要考虑的方程式是
$$
\mi \hs \dv{t} \ket{\psi(t)} = \hat{H}
(t) \ket{\psi(t)}\tag{72}$$
在这里，我们允许哈密顿算符是时间相关的.

## 3.1. 哈密顿量不显含时间

首先考虑哈密顿算符没有时间依赖性的情况。在这种情况下，将哈密顿算符表示为 $\hat{H}$，那么在时刻 $t$ 下的状态向量可以形式化地表示为
$$
\ket{\psi(t)} = \me^{-\mi \hat{H} t/ \hs} \ket{\psi(0)}\tag{73}
$$

在这里，$\ket{\psi(0)}$ 是时刻 $t = 0$ 的初始状态向量。下面将讨论通过多种方法讨论数值计算式 (73) 的方法。

### 3.1.1. 对角化法

在进行时间演化计算之前，假设我们对哈密顿算符 $\hat{H}$ 进行对角化。*哈密顿量的*本征值和本征向量定义如下：

$$\hat{H} \ket{\varphi_i} = E_i \ket{\varphi_i}\tag{74}$$

在这里，假设本征向量已经被正交归一化，即 $\ip{\varphi_i}{\varphi_j} = \delta_{ij}$. 在有本征值和本征向量的情况下，我们可以轻松地获取任意时刻的状态向量。下面将展示这一点。

由于固有态构成一个完备基，*初始态矢*可以展开如下：
$$
\ket{\psi(0)} = \sum_i A_i \ket{\varphi_i}\tag{75}
$$

^754407

其中 $A_i \in \mathbb{C}$, 满足
$$
\sum_{i} \abs{A_i}^2 = 1\tag{76}
$$

若已知了展开系数, 则任意 $t$ 时刻的态矢
$$
\ket{\psi(t)} = \sum_i A_i \me^{-\mi E_i t/\hs}\ket{\varphi_i}\tag{77}
$$

然而，在这里 $A_i$ 仍然是未知的量，因此需要求解它。

#### 系数求解

下面考虑计算 $A_i$ 的步骤. 首先，假设计算的基底是 $\ket{\vb*{n}}$.

我们假设计算的基底形成了完备基. 哈密顿算符的固有态可以用计算的基底表示

$$
\ket{\varphi_i} = \sum_{\vb*{n}} B_{i, \vb*{n}}\ket{\vb*{n}}\tag{78}
$$

^4c550a

其中, $B_{i, \vb*{n}}$ 是复数. 初期态矢用这个计算基底展开
$$
\ket{\psi(0)} = \sum_{\vb*{n}} C_{\vb*{n}} \ket{\vb*{n}}\tag{79}
$$

^9a1abc

其中, $C_{\vb*{n}}$ 是复数, 满足
$$
\sum_\vb*{n} \abs{C_{\vb*{n}}}^2=1\tag{80}
$$

利用式子 [[#^754407]], [[#^4c550a]], [[#^9a1abc]] 可以得到以下关系式
$$
\begin{align}
\sum_{i} A_i \ip{\vb*{n}}{\varphi_i} &= C_\vb*{n}\\
\Rightarrow C_{\vb*{n}} &= \sum_i A_i B_{i, \vb*{n}}
\end{align}\tag{81}
$$
$$
\begin{align}
\sum_{\vb*{n}} C_{\vb*{n}} \ip{\varphi_i}{\vb*{n}} &= A_i\\
\Rightarrow A_i &= \sum_i C_\vb*{n} B_{i, \vb*{n}}^*
\end{align}\tag{82}
$$

综上, 时刻 $t$ 的态矢
$$
\begin{align}
\ket{\psi(t)} &= \me^{-\mi \hat{H}t/\hs}\ket{\psi(0)}\\
&= \sum_i \me^{-\mi E_i t/\hs} \ip{\varphi_i}{\psi(0)} \ket{\varphi_i}\\
&= \sum_i A_i \me^{-\mi E_i t/\hs} \ket{\varphi_i}
\equiv \sum_i A_i(t) \ket{\varphi_i}\tag{83}\\
&= \sum_{i,\vb*{n}} A_i B_i \me^{-\mi E_i t/\hs}\ket{\vb*{n}}
\equiv \sum_{\vb*{n}} C_{\vb*{n}}(t) \ket{\vb*{n}}\tag{84}
\end{align}
$$
其中
$$
A_i(t) \equiv A_i \me^{-\mi E_i t/\hs}\tag{85}
$$
$$
C_\vb*{n}(t) \equiv \sum_i A_i B_i \me^{-\mi E_i t/\hs}
= \sum_i A_i(t) B_{i, \vb*{n}}\tag{86}
$$
由此可以计算 $\hat{O}$ 在时刻 $t$ 的期待值
$$
\begin{align}
\mel*{\psi(t)}{\hat{O}}{\psi(t)}
&= \sum_{i,j,\vb*{n},\vb*{m}}
\me^{-\mi (E_i-E_j)t/\hs}A_iA_j^*
B_{i,\vb*{m}}B_{j,\vb*{n}}^* \mel*{\vb*{n}}{\hat{O}}{\vb*{m}}\\
&= \sum_{\vb*{n}, \vb*{m}} C_\vb*{n}^*(t) C_\vb*{m}(t)
\ev*{\hat{O}}{\vb*{n}}\tag{87}
\end{align}
$$
换句话说，我们只需要创建一个数值计算 $C_{\vb*{n}}(t)$ 的例程.

### 3.1.2. Krylov 子空间法

在这里，从时刻 $t$ 的状态向量获得时刻 $t + \Delta t$ 的方法是
$$\ket{\psi(t+\Delta t)}
= \me^{-\mi \hat{H} \Delta t/\hs} \ket{\psi(t)}\tag{88}$$

^1d1421

换句话说，与对角化不同，这是一种从 $t = 0$ 开始逐步计算时间演化的方法。

一般来说，只要能够进行对角化，就可以获得任意时刻的状态向量。然而，在矩阵尺寸较大的系统中，对角化所需的时间和计算资源非常巨大。

在研究中，可能需要多次对角化，因为需要在不同参数下进行研究. 例如在具有随机势能的系统的时间演化中。在这种情况下，逐步时间演化法会更加实用。这是因为在该方法中，不使用所有的特征值和特征向量，所以计算成本比对角化低。在哈密顿算符不随时间变化的情况下，使用基于 Krylov 子空间的时间演化法是一种强大的方法[^5][^6]。下面将对此进行讨论。

为了理解 Krylov 子空间，首先介绍 Lanczos 方法。首先准备一个已归一化的状态向量 $\ket{u_1}$，满足 $\ip{u_1}=1$. 

将哈密顿算符作用于该向量，结果为
$$
\hat{H} \ket{u_1} = \alpha_1 \ket{u_1} + \beta_1 \ket{u_2}\tag{89}
$$

^3ea7e1

这里，定义了一个与 $\ket{u_1}$ 正交且已归一化的状态向量 $\ket{u_2}$. 换句话说, $\ip{u_2}{u_2}=1$, $\ip{u_2}{u_1}=0$. 根据这个定义，$\alpha_1$ 可以表示为：
$$
\alpha_1 = \mel*{u_1}{\hat{H}}{u_1}\tag{90}
$$
根据定义，$α_1$ 是实数。$β_1$ 可以从式 [[#^3ea7e1]] 的变形
$$
\ket{u_2} = \frac{1}{\beta_1}(\hat{H}-\alpha_1)\ket{u_1}\tag{91}
$$
以及归一化条件得到
$$
\beta_1 = \sqrt{\mel*{u_1}{(\hat{H}-\alpha_1)^\dagger (\hat{H}-\alpha_1)}{u_1}}\tag{92}
$$

然后, 将 $\hat{H}$ 作用于 $\ket{u_2}$
$$
\hat{H} \ket{u_2} = \alpha_2 \ket{u_2}
+ \beta_1 \ket{u_1} + \beta_2 \ket{u_3}\tag{93}
$$
在这里，假设 $\ket{u_3}$ 是一个已经归一化并且与 $\ket{u_1}$ 和 $\ket{u_2}$ 正交的向量. 关于 $\ket{u_3}$, $\alpha_2$ 和 $\beta_2$ 的表达式如下所得：
$$
\begin{align}
\ket{u_3} &= \frac{1}{\beta_2} \qty[(\hat{H} - \alpha_2)\ket{u_2}-\beta_1\ket{u_1}]\tag{94}\\
\alpha_2 &= \ev*{\hat{H}}{u_2}\tag{95}\\
\beta_2 &= \sqrt{\qty[\bra{u_2}(\hat{H}-\alpha_2)-\beta_1 \bra{u_1}]\qty[(\hat{H}-\alpha_2)\ket{u_2}-\beta_1 \ket{u_1}]}\tag{96}
\end{align}
$$
通过重复上述过程，我们可以得到以下的递推式

$$
\begin{align}
\hat{H}\ket{u_j} &= \alpha_j \ket{u_j}
+ \beta_{j-1} \ket{u_{j-1}} + \beta_j \ket{u_{j+1}},\quad (j=1,2,\cdots,N)\tag{97}\\
\alpha_j &= \ev*{\hat{H}}{u_j}\tag{98}\\
\beta_j &= \sqrt{\qty[\bra{u_j}(\hat{H}-\alpha_j)-\beta_{j-1} \bra{u_{j-1}}]\qty[(\hat{H}-\alpha_j)\ket{u_j}-\beta_{j-1} \ket{u_{j-1}}]}\tag{99}
\end{align}
$$
在这里，我们定义了 $\ket{u_0} = 0$、$β_0 = 0$ 和 $β_N = 0$. 

通过前面的结果，我们可以看出哈密顿算符的矩阵表示变成了以下的三重对角矩阵：

$$
H = \mqty[
\alpha_1 & \beta_1 & 0 & \cdots\\
\beta_1 & \alpha_2 & \beta_2 & 0 & \cdots\\
0 & \beta_2 & \alpha_3 & \beta_3 & 0\\
& & \ddots & \ddots & \ddots & \\
&& 0 & \beta_{N-2} & \alpha_{N-1} & \beta_{N-1}\\
&&& 0 & \beta_{N-1} & \alpha_N
]\tag{100}
$$

在数值上对三重对角矩阵进行对角化是一个常见的任务，可以使用经典的例程来完成。

需要注意的是，通过数值计算获得的向量 $\ket{u_1}, \cdots, \ket{u_N}$ 由于数值误差可能会失去正交性。为了避免这个问题，可以采取以下步骤（重新正交化）。

假设通过递推式 (97) 获得了 $\ket{u_{j+1}}$. 在这种情况下，可以通过 [[格拉姆-施密特方法|Gram-Schmidt 的正交化方法]]获得 $\ket{u_{j+1}'}$
$$
\ket{u_{j+1}'} = \ket{u_{j+1}} - \sum_{n=1}^{j-2} \frac{\ip{u_n}{u_{j+1}}}{\ip{u_n}}\ket{u_n}\tag{101}
$$
需要注意的是，这里没有使用 $\ket{u_j}$ 和 $\ket{u_{j-1}}$，因为根据定义，$\ip{u_{j-1}}{u_{j+1}} = \ip{u_j}{u_{j+1}}=0$. 这个计算完成后，可以将 $\ket{u_{j+1}'}$ 作为新的 $\ket{u_{j+1}}$，然后计算 $β_j$. 

以上就是利用 Krylov 子空间方法进行时间演化的准备步骤。在这种方法中，考虑使用式 ([[#^1d1421|88]]) 逐步进行时间演化：
$$\ket{\psi(t+\Delta t)}
= \me^{-\mi \hat{H} \Delta t/\hs} \ket{\psi(t)}\tag{102}$$
时刻 $t$ 的态矢做展开
$$
\ket{\psi(t)}=\sum_\vb*{n}C_\vb*{n}(t)\ket{\vb*{n}}\tag{103}
$$
再引入投影算符 $\hat{P}_N$
$$
\hat{P}_N \equiv \sum_{j=1}^N \op{u_j}\tag{104}
$$
其中 $\ket{u_j}$ 是利用 Lanczos 法得到的第 $j$ 个 Lanczos 矢量. $N$ 是 Lanczos 矢的数目.

将 Lanczos 矢用基底 $\ket{\vb*{n}}$ 展开
$$
\ket{u_j}=\sum_{\vb*{n}} U_{\vb*{n}}^j\ket{\vb*{n}}\tag{105}
$$
利用 Krylov 子空间法, 将 $\ket{\psi(t+\Delta t)}$ 做近似
$$
\begin{align}
\ket{\psi(t+\Delta t)} &\simeq \hat{P}_N \me^{-\mi \hat{H} \Delta t/\hs} \hat{P}_N \ket{\psi(t)}\\
&= \sum_{n=0}^\infty \frac{(-\mi \Delta t)^n}{n!}\hat{P}_N
\hat{H}^n \hat{P}_N \ket{\psi(t)}\\
&\simeq \sum_{n=0}^\infty \frac{(-\mi \Delta t)^n}{n!}
\hat{P}_N \hat{T}^n \hat{P}_N \ket{\psi(t)}\\
&= \hat{P}_N \me^{-\mi \hat{T} \Delta t/\hs}\hat{P}_N \ket{\psi(t)}\tag{106}
\end{align}
$$
其中, $\hat{T}$ 为
$$
\hat{T} \equiv \sum_{i,j} \op{u_i} \hat{H} \op{u_j}
\equiv \sum_{i,j} T_{ij} \op{u_i}{u_j}\tag{107}
$$
在这里，定义了一个 $N × N$ 的三重对角矩阵，它就是式 (100) 所表示的。由于数值上对三重对角矩阵进行对角化是比较容易的，我们可以对其进行对角化，并求解其固有值和固有向量, 可以写作

$$
\begin{align}
\hat{T} &= \sum_l D_l \op{\varphi_l}\tag{108}\\
\hat{T} \ket{\varphi_l} &= D_l \ket{\varphi_l}\tag{109}\\
\ket{\varphi_l} &\equiv \sum_k A_k^{(l)} \ket{u_k}\tag{110}
\end{align}
$$
由此 (106) 式为
$$
\ket{\psi(t+\Delta t)} = \hat{P}_N \sum_l \me^{-\mi D_l \Delta t/\hs} \ket{\varphi_l} \mel*{\varphi_l}{\hat{P}_N}{\psi(t)}\tag{111}
$$
在这里, $\ket{u_1} = \ket{\psi(t)} / \sqrt{\ip{\psi(t)}}$. 综上, 式 (111)
$$
\begin{align}
\ket{\psi(t+\Delta t)} &= \hat{P}_N \sum_l \me^{-\mi D_l \Delta t/\hs} \ket{\varphi_l} \mel*{\varphi_l}{\hat{P}_N}{u_1}\\
&=\sqrt{\ip{\psi(t)}}\sum_l \me^{-\mi D_l \Delta t /\hs}\sum_j \ket{u_j} \ip{u_j}{\varphi_j} \ip{\varphi_j}{u_1}\\
&= \sqrt{\ip{\psi(t)}}\sum_{l,j} \me^{-\mi D_l \Delta t /\hs}
A_j^{(l)}\qty[A_1^{(l)}]^* \ket{u_j}\\
\Rightarrow \quad \ip{\vb*{n}}{\psi(t+\Delta t)} &=
\sqrt{\ip{\psi(t)}}\sum_{l,j} \me^{-\mi D_l \Delta t /\hs}
A_j^{(l)}\qty[A_1^{(l)}]^* U_\vb*{n}^j\\
&= \sqrt{\ip{\psi(t)}}\sum_{j} U_{\vb*{n}}^j
\qty[\sum_l \me^{-\mi D_l \Delta t/\hs}A_j^{(l)} \qty[A_1^{(l)}]^*]\tag{112}
\end{align}
$$
由此, 时刻 $t + \Delta t$ 的状态向量通过 Krylov 子空间法获得.

在这里，我们将讨论收敛判据。实际上，通过 Lanczos 算法生成 Lanczos 向量，每次都进行对角化。然后，使用获得的新 Lanczos 向量（记为 $\ket{u_i}$ ）来计算
$$
c_j^{(i)} \equiv \sum_{l=1}^i \me^{-\mi D_l \Delta t/\hs}
A_j^{(l)} \qty[A_1^{(l)}]^*\tag{113}
$$

当 $\abs{c_{j=i}^{(i)}}$ 的值小于一个足够小的值 $\epsilon(>0)$ 时，可以判断为已经收敛.

Lanczos 方法的优点在于，相对于当前考虑的 Hilbert 空间的维度，$N$ 的值要小得多，计算就可以收敛。

需要的 Lanczos 向量数量取决于系统的细节和 $∆t$ 的大小，因此只能通过试验和错误来决定。一般来说，选择较大的 $∆t$ 会需要更多的 Lanczos 向量。有关数值误差的问题，请参考文献[^5][^6].

## 3.2. 哈密顿量显含时间

接下来，我们考虑哈密顿算符明确地依赖于时间的情况。在这种情况下，对角化和 Krylov 子空间法都不适用，因此需要使用其他方法。

### 3.2.1. 龙格-库塔法

时间依赖的薛定谔方程在矩阵表示中可以看作是线性的常微分方程组。解这种常微分方程组的标准数值计算方法之一是著名的 [[龙格-库塔法|Runge-Kutta 法]]。在这里，我们将介绍这个方法。

在这里用以下的常微分方程组为例
$$
\dv{t}\vb*{x}(t) = \vb*{f}(\vb*{x}(t),t)\tag{114}
$$
在这里, $\vb*{x}, \vb*{f} \in \mathbb{C}^N$. 令 $\Delta t$ 为时间间隔, $\vb*{x}_n$ 为 $\vb*{x}(t)$ 在 $t_n$ 时刻的值. 并且, $t_n \equiv \Delta t \times n\ (n=0,1,2,\cdots)$. 

常用的标准 4 阶 Runge-Kutta 法是通过以下步骤计算时刻 $t_{n+1}$ 处的 $\vb*{x}(t)$ 的数值方法：

$$
\begin{align}
\vb*{x}_{n+1} &= \vb*{x}_n + \frac{\Delta t}{6}
(\vb*{k}_1 + 2\vb*{k}_2 + 2\vb*{k}_3 + \vb*{k}_4)\tag{115}\\
\vb*{k}_1 &= \vb*{f}(\vb*{x}_n,t_n)\tag{116}\\
\vb*{k}_2 &= \vb*{f}(\vb*{x}_n+\Delta t \vb*{k}_1/2, t_n+\Delta t/2)\tag{117}\\
\vb*{k}_3 &= \vb*{f}(\vb*{x}_n + \Delta t \vb*{k}_2/2, t_n + \Delta t/2)\tag{118}\\
\vb*{k}_4 &= \vb*{f}(\vb*{x}_n + \Delta t \vb*{k}_3, t_n + \Delta t)\tag{119}
\end{align}
$$

我们考虑将 Runge-Kutta 法应用于薛定谔方程。行列形式的薛定谔方程如下：
$$
\begin{align}
\dv{t} \ip{\vb*{n}}{\psi(t)}
&= -\frac{\mi}{\hs}
\sum_{\vb*{m}}H_{\vb*{n}, \vb*{m}}(t)
\ip{\vb*{m}}{\psi(t)}\\
\Rightarrow \dv{t} C_{\vb*{n}}(t)&=
-\frac{\mi}{\hs} \sum_{\vb*{m}}H_{\vb*{n},\vb*{m}}(t)\ C_\vb*{m}(t)\tag{120}
\end{align}
$$

在这里，定义了 $H_{\vb*{n},\vb*{m}} \equiv \mel*{\vb*{n}}{\hat{H}(t)}{\vb*{m}}$. 因此，可以通过以下步骤计算时间演化：
$$
\begin{align}
C_{\vb*{n}}(t+\Delta t)
&= C_\vb*{n}(t) + \frac{\Delta t}{6}
(k_{1,\vb*{n}}+2k_{2,\vb*{n}}+2k_{3,\vb*{n}}+k_{4,\vb*{n}})\tag{121}\\
k_{1,\vb*{n}}&= -\frac{\mi}{\hs}\sum_{\vb*{m}}H_{\vb*{n},\vb*{m}}(t) C_\vb*{m}(t)\tag{122}\\
k_{2, \vb*{n}} &= -\frac{\mi}{\hs} \sum_{\vb*{m}}H_{\vb*{n},\vb*{m}}(t+\Delta t/2)\qty[C_{\vb*{m}}(t) + \frac{\Delta t}{2} k_{1, \vb*{m}}]\tag{123}\\
k_{3,\vb*{n}} &= -\frac{\mi}{\hs}\sum_{\vb*{m}} H_{\vb*{n},\vb*m}(t+\Delta t/2)\qty[C_{\vb*{m}}(t) + \frac{\Delta t}{2} k_{2, \vb*{m}}]\tag{124}\\
k_{4,\vb*{n}} &= 
-\frac{\mi}{\hs}\sum_{\vb*{m}} H_{\vb*{n},\vb*m}(t+\Delta t) \qty[
C_{\vb*{m}}(t) + \Delta t k_{3, \vb*{m}}
]
\end{align}
$$

需要注意的是，Runge-Kutta 法不保持状态向量的范数。当进行长时间的时间演化时，这个问题可能变得更加显著。


[^1]: A. W. Sandvik, in Lectures on the Physics of Strongly Correlated Systems XIV: Fourteenth Training Course in the Physics of Strongly Correlated Systems, edited by A. Avella and F. Mancini, AIP Conf. Proc. No. 1297, (AIP, New York, 2010), p 135.
[^2]: J. M. Zhang and R. X. Dong, Eur. J. Phys. 31, 591 (2010). [[精确对角化：以 Bose-Hubbard 模型作为例子]]
[^3]: A. I. Streltsov, O. E. Alon, and L. S. Cederbaum, Phys. Rev. A 81, 022124 (2010). [[Fock 空间玻色, 费米算符的一般映射]]
[^4]: J.-H. Jung and J. D. Noh, J. Korean Phys. Soc. 76, 670 (2020). [[量子热化的精确对角化指南]]
[^5]: M. Hochbruck and C. Lubich, SIAM J. NUMER. ANAL. 34, 1911 (1997).
[^6]: S. Paeckel, T. Köhler, A. Swoboda, S. R. Manmana, U. Schollwöck, and C. Hubig, Ann. Phys. (N. Y.) 411, 167998 (2019).

