本章开始本书的第二部分，我们将详细探讨量子计算。本章发展了量子计算的基本原理，并建立了量子电路的基本构建块，量子电路是描述复杂量子计算的通用语言。目前已知的两种基本量子算法将在接下来的两章中由这些电路构建。第五章介绍了*量子傅里叶变换*及其在相位估计、order-finding 和因式分解中的应用。第 6 章描述了量子搜索算法及其在 NP 完全问题解的数据库搜索、计数和加速中的应用。第七章总结了第二部分，讨论了量子计算有一天如何在实验中实现。另外两个对量子计算非常感兴趣的话题，量子噪声和量子纠错，推迟到本书的第三部分，因为它们在量子计算之外也有广泛的兴趣。

本章主要介绍两个思想。首先，我们详细解释了量子计算的基本模型——量子电路模型。其次，我们证明了存在一组通用的门，也就是说，任何量子计算都可以用这些门来表示。在此过程中，我们也有机会描述量子计算的许多其他基本结果。[[#4.1. 量子算法|第4.1节]]以量子算法的概述开始本章，重点介绍已知的算法，以及它们构建的统一技术。[[#4.2. 单量子位运算|第4.2节]]详细研究了单量子位操作。尽管它们很简单，但单量子位操作为构建示例和技术提供了丰富的平台，详细了解它们是必不可少的。[[#4.3. Controlled 操作|第4.3节]]展示了如何执行多量子位控制的幺正操作，第4.4节讨论了量子电路模型中测量的描述。然后在第4.5节中把这些要素集合起来，用以陈述和证明普适定理。我们在4.6节中总结了量子计算的所有基本元素，并讨论了该模型的可能变体，以及经典计算机和量子计算机之间计算能力关系的重要问题。4.7节以量子计算在真实量子系统模拟中的重要和有指导意义的应用来结束本章。

这一章可能是本书所有章节中读者最密集的章节，有高密度的练习需要你完成，有必要解释一下这种强度的原因。掌握量子电路计算模型的基本元素是很容易的，但需要吸收大量简单的结果和技术，如果要解决设计量子算法的更困难的问题，这些结果和技术必须成为第二天性。出于这个原因，我们在本章中采用面向示例的方法，并要求您填写许多细节，以便获得这样的功能。对于量子计算的基本元素，可以跳到第4.6节，这是一个不那么密集，但有些肤浅的概述。

## 4.1. 量子算法

量子计算机有什么好处?我们都熟悉需要更多计算机资源来解决计算问题的挫败感。实际上，许多有趣的问题是不可能在经典计算机上解决的，不是因为它们在原则上无法解决，而是因为解决问题的实际情况所需的天文资源。量子计算机的惊人前景是使新的算法能够在经典计算机上解决需要过高资源的可行问题。

在撰写本文时，已知有两大类量子算法可以实现这一承诺。第一类算法基于 Shor 的量子傅立叶变换，包括解决因式分解和离散对数问题的出色算法，提供了比最著名的经典算法显著的指数加速。第二类算法是基于 Grover 算法进行量子搜索的。相对于最好的经典算法，这些算法提供了一个不那么惊人但仍然显著的二次加速。量子搜索算法的重要性来源于经典算法中基于搜索的技术的广泛应用，在许多情况下，这使得经典算法可以直接适应以获得更快的量子算法。

图 4.1 概述了在撰写本文时关于量子算法的知识状态，包括这些算法的一些示例应用。自然，图的核心是量子傅里叶变换和量子搜索算法。图中特别有趣的是量子计数算法。该算法是量子搜索和傅里叶变换算法的巧妙结合，可以比传统计算机更快地估计搜索问题的解的数量。

量子搜索算法有许多潜在的应用，但其中很少有例子。它可以用于从无序数据集中提取统计数据，例如最小元素，比在传统计算机上更快。它可以用来加速 NP 中某些问题的算法，特别是那些直接搜索解是已知最佳算法的问题。最后，它可以用来加快对密码系统(如广泛使用的数据加密标准DES)的密钥的搜索。这些和其他应用将在第6章中解释。

量子傅里叶变换也有许多有趣的应用。它可以用来解决离散对数和因式分解问题。这些结果反过来又使量子计算机能够破解目前使用的许多最流行的密码系统，包括 RSA 密码系统。傅里叶变换也被证明与数学中的一个重要问题密切相关，即寻找隐藏的子群(寻找周期函数周期的推广)。量子傅里叶变换和它的几个应用，包括分解和离散对数的快速量子算法，在第5章中解释。

为什么比经典算法更好的量子算法如此之少? 答案是，想出好的量子算法似乎是一个难题。这至少有两个原因。首先，算法设计，无论是经典的还是量子的，都不是一件容易的事! 算法的历史告诉我们，要想出接近最优的算法，往往需要相当大的创造力，即使是对于看起来非常简单的问题，比如两个数字的乘法。找到好的量子算法是加倍困难的，因为我们希望我们的量子算法比最著名的经典算法更好。很难找到好的量子算法的第二个原因是，我们的直觉更适合经典世界，而不是量子世界。如果我们用自己的直觉来思考问题，那么我们提出的算法就会是经典算法。想出好的量子算法需要特殊的洞察力和特殊的技巧。

量子算法的进一步研究将推迟到下一章。在本章中，我们提供了一种高效而强大的语言来描述量子算法，量子电路语言-描述计算过程的离散组件集的集合。这种结构将使我们能够根据所需的门的总数或电路深度等因素来量化算法的成本。电路语言还附带了一个技巧工具箱，简化了算法设计并提供了现成的概念理解。

## 4.2. 单量子位运算

我们的量子计算工具包的开发始于对所有量子系统中最简单的操作-单个量子比特。在1.3.1节中介绍了单量子比特门。让我们快速总结一下我们在那里学到的东西; 你可能会发现，在我们进行的过程中，参考第二十三页关于记号的注释是有用的。

单个量子比特是一个向量 $\ket{\psi} = a\ket{0} + b\ket{1}$，由满足 $\abs{a}^2 + \abs{b}^2 = 1$ 的两个复数参数化。量子位上的操作必须保持这个范数，因此用 $2 \times 2$ 幺正变换来描述。其中，最重要的是泡利矩阵; 在这里再次列出它们是有用的:
$$
X \equiv \mqty[0&1\\1&0],\quad Y \equiv \mqty[0 & -\mi \\ \mi & 0],\quad Z\equiv \mqty[1 & 0\\0&-1]\tag{4.1}
$$
另外三个量子门将在接下来的过程中发挥重要作用，即 Hadamard 门(表示 $H$ )，相位门(表示 $S$ )和 $\pi / 8$ 门(表示 $T$ ):
$$
H \equiv \frac{1}{\sqrt{2}}\mqty[1&1\\1&-1],\quad
S \equiv \mqty[1&0\\0& \mi],\quad
T \equiv \mqty[1&0\\0 &\exp(\mi \pi / 4)] \tag{4.2}
$$

要记住的几个有用的代数事实是 $H =(X+Z)/ \sqrt{2}$ 和 $S = T^2$。你可能想知道为什么 $T$ 门被称为 $\pi/8$ 门，而在定义中出现的是 $\pi/4$。原因是这个门在历史上经常被称为 $\pi / 8$ 门，仅仅是因为在一个不重要的全局相位下，$T$ 等于一个门，其对角线上出现 $\exp( \pm \mi \pi/8)$.
$$
T = \exp( \mi \pi / 8) \mqty[\exp(-\mi \pi / 8)&0\\0 & \exp(\mi \pi / 8)] \tag{4.3}
$$
然而，这个命名法在某些方面是相当不幸的，我们经常把这个门称为 $T$ 门。还回想一下，状态为 $a\ket{0} +b\ket{1}$ 的单个量子比特可以被可视化为单位球面上的一个点 $(\theta, \phi)$，其中 $a =\cos(\theta/2)$, $b = \me^{i\phi} \sin(\theta/2)$，并且 $a$ 可以被认为是实数，因为状态的整体相位是不可观察的。这被称为 Bloch 球表示法，向量 $(\cos \phi \sin \theta, \sin \phi \sin \theta, \cos \theta)$ 被称为 Bloch vector. 我们将经常回到这幅图画来帮助我们的直觉。

```ad-question
title: 练习 4.1
在练习 2.11 中，如果你还没有做的话，你现在应该做一下，你计算了泡利矩阵的特征向量。找出布洛赫球上对应于不同泡利矩阵的归一化特征向量的点。
```
当泡利矩阵取幂时，可以得到三种有用的幺正，即由方程定义的关于 $x, y$ 和 $z$ 轴的旋转算符
$$
\begin{align}
R_x(\theta) &= \me^{\mi \theta X/2}=\cos \frac{\theta}{2} I-\mi \sin \frac{\theta}{2} X = \mqty[\cos \frac{\theta}{2} & -\mi \sin \frac{\theta}{2}\\ - \mi \sin \frac{\theta}{2} & \cos \frac{\theta}{2}] \tag{4.4}\\
R_y(\theta) &= \me^{\mi \theta Y/2} = \cos \frac{\theta}{2} I-\mi \sin \frac{\theta}{2} Y = \mqty[\cos \frac{\theta}{2} & -\sin \frac{\theta}{2}\\ \sin \frac{\theta}{2} & \cos \frac{\theta}{2}] \tag{4.5}\\
R_z(\theta) &= \me^{\mi \theta Z/2} = \cos \frac{\theta}{2} I-\mi \sin \frac{\theta}{2} Z = \mqty[\me^{-\mi \theta/2} & 0\\0 & \me^{\mi \theta/2}] \tag{4.6}
\end{align}
$$
单个量子比特上的任意 unitary 算符可以以多种方式写成旋转的组合，以及量子比特上的全局相移。下面的定理提供了一种表达任意单量子位旋转的方法，这将在以后的控制操作应用中特别有用。

> **定理 4.1: (单量子位的 $Z\text{-}Y$分解)**
> 假设 $U$ 是单量子位上的幺正运算。则存在实数 $\alpha, \beta, \gamma$ 和 $\delta$，使得
> $$U = \me^{\mi \alpha} R_z(\beta) R_y(\gamma) R_z(\delta) \tag{4.11}$$

> **推论 4.2:** 假设 $U$ 是单个量子位上的幺正。那么在单个量子比特上存在幺正算符 $A,B,C$ 使得 $ABC = I$, $U = \me^{\mi \alpha} AXBXC$，其中 $\alpha$ 是某个总相位因子.

常见单量子比特门的符号如图 4.2 所示。回想一下量子电路的基本性质: 时间从左向右进行; 导线代表量子位，“/” 可以用来表示一束量子位.![[截图-1716831443616.png#R|单量子比特门的名称，符号，和幺正矩阵|300]]


## 4.3. Controlled 操作

如果 A 是正确的，那么做 B。这种类型的控制操作是在经典和量子计算中最有用的操作之一。在本节中，我们将解释如何使用由基本操作构建的量子电路来实现复杂的控制操作。

典型的受控操作是我们在 [[1. 简介及概述#1.2.1. 多量子位|1.2.1 节]]中遇到的 CNOT 操作。回想一下，我们经常提到的这个 CNOT，是一个具有两个输入量子位的量子门，分别称为控制量子位和目标量子位。绘制如图 4.3 所示。在计算基上, CNOT 的操作为: $\ket{c}\ket{t} \to \ket{c} \ket{t \oplus c}$. 也就是说，如果控制量子位被设置为 $\ket{1}$，那么目标量子位将被翻转，否则目标量子位将保持不变。因此，在计算基 $\ket{\text{contrl, target}}$ 中，矩阵表示为![[截图-1716831954733.png#R|Fig. 4.3. CNOT 门的电路表示。上面一行代表控制量子比特，下面一行代表目标量子比特|200]]
$$
\mqty[1&0&0&0\\0&1&0&0\\0&0&0&1\\0&0&1&0]\tag{4.23}
$$
更一般地说，假设 $U$ 是一个任意的单量子位幺正。controlled $U$ 操作是两个量子位操作，同样具有一个控制量子位和一个目标量子位。如果设置了控制量子位，则 $U$ 作用于目标量子位，否则不作用于目标量子位; 即 $\ket{c} \ket{t} \to \ket{c} U_c \ket{t}$. Controlled $U$ 操作由图 4.4 所示电路表示。

> **Fig. 4.4** 控制 $U$ 操作。上面一行是控制量子比特，下面一行是目标量子比特。如果设置了控制量子位，则将 $U$ 应用于目标，否则将其单独保留。![[截图-1716832192165.png#R|Fig. 4.4|200]]

我们的直接目标是了解如何实现任意单量子位 $U$ 的受控 $U$ 操作，仅使用单量子位操作和 CNOT 门。我们的策略是基于第 176 页推论 4.2 中给出的分解 $U = \me^{\mi \alpha} AXBXC$ 的两部分过程。

我们的第一步将是在目标量子比特上应用相移 $\exp(\mi \alpha)$，由控制量子比特控制。也就是说，如果控制量子位为 $\ket{0}$，则保持目标量子位不变，而如果控制量子位为 $\ket{1}$，则对目标施加相移 $\exp(\mi \alpha)$。图 4.5 右侧描述了仅使用单个量子位幺正门实现此操作的电路。为了验证该电路是否正确工作，请注意右边电路的效果是![[截图-1716832390215.png#R|Fig. 4.5. 控制相移门和两个量子位的等效电路|300]]

$$
\ket{00}\to \ket{00}, \ket{01}\to\ket{01},\ket{10}\to \me^{\mi \alpha} \ket{10},
\ket{11}\to \me^{\mi \alpha} \ket{11}\tag{4.28}
$$


这正是左边控制操作所需要的。

现在我们可以完成受控u操作的构造，如图 4.6 所示。为了理解这个电路的工作原理，回顾推论4.2,U可以写成U = eiαAXBXC的形式，其中A, B和C是单量子位操作，使得ABC = i。假设控制量子位被设置。然后对第二个量子位进行eiαAXBXC = U运算。另一方面，如果没有设置控制量子位，则对第二个量子位进行ABC = I操作;也就是说，没有进行任何更改。也就是说，该电路实现了受控u操作。

> **Fig. 4.6** ![[截图-1716872776728.png#R|Fig. 4.6|300]]实现单量子位 $U$ 的 controlled-$U$ 操作的电路. $\alpha, A, B$ 和 $C$ 满足 $U=\exp (\mi \alpha)AXBXC$, $ABC = I$.







## 4.4. 测量

量子电路中使用的最后一个元素，有时几乎是隐含的，就是测量。在我们的电路中，我们将使用 “meter” 符号表示计算基础中的投影测量 (第2.2.5节)，如图 4.14 所示。在量子电路理论中，通常不使用任何特殊符号来表示更一般的测量，因为，正如第 2 章所解释的那样，它们总是可以用带有辅助量子位的幺正和投影测量来表示。

关于量子电路，有两个重要的原则是值得牢记的。这两个原则都很明显; 然而，它们有如此大的效用，值得尽早强调。第一个原理是经典条件运算可以被量子条件运算取代:

> **Fig. 4.12** 控制 $U$ 操作及其等效电路元件，我们已经知道如何实现。如果第一个和第三个量子位设置为零，第二个量子位设置为 1，则第四个量子位应用 $U$.![[截图-1716836263698.png#R|Fig. 4.12|300]]

> **延迟测量原理**: 测量总是可以从量子电路的中间阶段移动到电路的末端; 如果测量结果用于电路的任何阶段，那么经典控制操作可以用条件量子操作代替。

通常，量子测量是作为量子电路的中间步骤进行的，测量结果用于有条件地控制后续的量子门。例如，在第 27 页的图 1.13 中的隐形传态电路中就是这种情况。然而，这样的测量总是可以移动到电路的末端。图 4.15 演示了如何通过用相应的量子条件操作替换所有经典条件操作来实现这一点。(当然，对这个电路进行“隐形传态”的一些解释是错误的，因为没有经典信息从 Alice 传递给 Bob，但很明显，两个量子电路的总体作用是相同的，这是关键点。)

第二条原则更加明显——而且出乎意料地有用!


> **Fig. 4.13** 在单个量子位上的投影测量符号。在这个电路中，没有对测量结果做任何进一步的处理，但是在更一般的量子电路中，有可能改变量子电路的后面部分，条件是电路早期部分的测量结果。这种对经典信息的使用是用双线绘制的线来描述的 (这里没有显示)。![[截图-1716836568519.png#R|Fig, 4.13|300]]

> **隐式测量原理**: 在不丧失一般性的前提下，量子电路末端的任何未终止的量子线(未测量的量子比特)都可以假定是被测量的。

为了理解为什么是这样，想象一下你有一个只包含两个量子位的量子电路，并且只有第一个量子位在电路的末端被测量。此时观测到的测量统计量完全由第一个量子位元的约简密度矩阵决定。然而，如果在第二个量子位上也进行了测量，那么如果该测量可以改变第一个量子位上的测量统计数据，那将是非常令人惊讶的。在练习4.32中，您将通过展示第一个量子位的简化密度矩阵不受对第二个量子位执行测量的影响来证明这一点。

当你考虑测量在量子电路中的作用时，重要的是要记住，作为量子世界和经典世界之间的接口，测量通常被认为是一种不可逆的操作，破坏量子信息并用经典信息代替它。然而，在某些精心设计的情况下，这并不一定是正确的，正如隐形传态和量子纠错(第10章)所生动说明的那样。隐形传态和量子纠错的共同之处在于，在这两种情况下，测量结果都不会透露任何有关被测量量子态身份的信息。事实上，我们将在第10章看到这是测量的一个更普遍的特征——为了使测量可逆，它必须不透露被测量的量子态的信息!


## 4.5. 通用量子门

### 4.5.2. 单量子位和 CNOT 门是通用的

### 4.5.5. 量子计算复杂性

## 4.6. 总结量子电路计算模型

在这本书中，术语“量子计算机”是计算的量子电路模型的同义词。本章详细介绍了量子电路、它们的基本元素、通用门族和一些应用。在我们继续讨论更复杂的应用之前，让我们总结一下量子电路计算模型的关键要素:
1. **经典资源**: 量子计算机由经典部分和量子部分两部分组成。原则上，不需要计算机的经典部分，但在实践中，如果部分计算可以经典地完成，某些任务可能会变得容易得多。例如，许多量子纠错方案(第10章)可能涉及经典计算，以最大化效率。虽然经典计算原则上总是可以在量子计算机上完成，但在经典计算机上执行计算可能更方便。
2. 一个合适的状态空间:一个量子电路在 $n$ 个量子比特上运行。因此状态空间是一个 $2^n$ 维复希尔伯特空间。形式为 $|x$ 1，…，xn，其中xi = 0,1，称为计算机的计算基态。|x表示计算基状态，其中x为二进制表示为x1…xn。
3. 计算基准备状态的能力:假设任意计算基状态|x1，…，则xn的制备最多需要n步。
4. 执行量子门的能力:门可以根据需要应用于量子比特的任何子集，并且可以实现一个通用的门家族。例如，应该可以将门应用于量子计算机中的任何一对量子位。Hadamard门、相位门和π/8门构成了一个门族，任何幺正运算都可以从这个门族近似出来，因此是一个通用的门集。还有其他的宇宙家庭。
5. 在计算基础上执行测量的能力:测量可以在计算机中的一个或多个量子位的计算基础上执行。

量子计算的量子电路模型与已经提出的许多其他计算模型等效，因为其他模型对相同问题的资源需求本质上是相同的。举一个简单的例子来说明这个基本思想，人们可能会想，转向基于三能级量子系统的设计，而不是基于两能级量子比特的设计，是否会带来任何计算优势。当然，尽管使用三能级量子系统(qutrits)可能比使用两能级系统有一些轻微的优势，但从理论的角度来看，任何差异基本上都可以忽略不计。在一个不那么平凡的层面上，“量子图灵机”计算模型，经典图灵机模型的量子推广，已经被证明与基于量子电路的模型等效。我们在本书中不考虑这种计算模型，但是对量子图灵机有兴趣的读者可以参考“历史和进一步阅读”章节末尾给出的参考资料。

尽管量子电路模型简单而有吸引力，但记住可能存在的批评、修改和扩展是有用的。例如，量子电路模型中状态空间和起始条件的基本假设是否合理，这一点并不清楚。一切都是用有限维状态空间来表述的。使用状态空间为无限维的系统会有什么收获吗?假定计算机的启动状态为计算基态也是没有必要的;我们知道自然界中的许多系统“更喜欢”处于许多系统的高度纠缠态;有没有可能利用这种偏好来获得额外的计算能力?它可能是访问特定的状态使得特定的计算比我们被限制在计算基础上更容易完成。同样，在多量子位基中有效地执行纠缠测量的能力可能与能够执行纠缠幺正操作一样有用。事实上，利用这种测量来执行量子电路模型中难以处理的任务是可能的。

对量子电路模型背后的物理学进行详细的检查和试图证明，超出了本文讨论的范围，而且确实超出了当前知识的范围!通过提出这些问题，我们希望引入量子电路模型的完整性问题，并再次强调信息是物理的这一基本观点。在我们试图为信息处理制定模型时，我们应该总是试图回到基本的物理定律。为了本书的目的，我们将停留在量子电路模型的计算中。它提供了一个丰富而强大的计算模型，利用量子力学的特性来执行令人惊叹的信息处理壮举，而没有经典的先例。是否存在超越量子电路模型的物理上合理的计算模型是我们留给你们的一个有趣的问题。

## 4.7. 量子系统模拟

让我们通过提供量子电路模型的一个有趣而有用的应用来结束本章。计算最重要的实际应用之一是物理系统的模拟。例如，在新建筑的工程设计中，采用有限元分析和建模来确保安全，同时最大限度地降低成本。通过计算机辅助设计，汽车变得轻巧、结构合理、美观、廉价。现代航空工程在很大程度上依赖于飞机设计的计算流体动力学模拟。核武器不再爆炸(大部分)，而是通过详尽的计算模型进行测试。由于预测模拟的大量实际应用，这样的例子比比皆是。我们首先描述了模拟问题的一些实例，然后给出了一个用于模拟的量子算法和一个说说性示例，最后给出了对该应用的一些看法。

### 4.7.1. Simulation in action

### 4.7.2. 量子模拟算法

经典模拟首先认识到，在求解一个简单的微分方程，如 $\dd{y}/\dd{t} = f(y)$，到一阶时，已知 $y(t + \Delta t) \approx y(t)+ f(y) \Delta t$. 类似地，量子情况与 $\mi \dd{\ket{\psi}} / \dd{t} = H \ket{\psi}$ 的解有关，对于时间无关的 $H$，它是
$$
\ket{\psi(t)} = \me^{-\mi H t} \ket{\psi(0)} \tag{4.96}
$$
由于 $H$ 通常极难求幂(它可能是稀疏的，但它也是指数大的)，一个好的开始是一阶解|ψ(t +Δt)≈(I−iHΔ)|ψ(t)。这是容易处理的，因为对于许多哈密顿H来说，组成量子门来有效地近似I - iHΔt是很简单的。然而，这种一阶解通常不是很令人满意。(4.96)式的解的高阶有效逼近，对于许多类的哈密顿函数都是可能的。例如，在大多数物理系统中，哈密顿量可以写成许多局部相互作用的和。具体来说，对于n个粒子的系统，

## 历史与深入阅读

本章中的闸门结构来自各种各样的来源。Barenco, Bennett, Cleve, DiVincenzo, Margolus, Shor, Sleator, Smolin和Weinfurter[BBC+95]的论文是本章中许多电路结构的来源，也是单量子比特和 CNOT 门的通用性证明的来源。关于量子电路的另一个有用的见解来源是Beckman, Chari, Devabhaktuni和Preskill的论文[BCDP96]。DiVincenzo[DiV98]提供了一个温和易懂的介绍。Griffiths和Niu[GN96]指出了测量与控制量子比特终端对易的事实。

二能级 unitary 的通用性证明是由Reck, Zeilinger, Bernstein, and Bertani[RZBB94]提出的。DiVincenzo[DiV95b]证明了 CNOT 和单量子比特门的通用性。练习4.44中的通用门G有时被称为Deutsch门[Deu89]。Deutsch, Barenco，和Ekert[DBE95]和Lloyd[Llo95]独立证明了几乎任何两个量子位的量子逻辑门都是通用的。Bernstein和Vazirani [BV97]证明了门序列引起的误差最多是单个门误差的总和。我们所关注的特定通用门集- Hadamard，相位，CNOT 和π/8门，在Boykin, Mor, Pulver, Roychowdhury和Vatan[BMP+99]中被证明是通用的，它还包含一个证明，θ由cos(θ/2)≡cos2(π/8)定义是π的无理性倍。第4.5.4节中的界是基于Knill[Kni95]的一篇论文，该论文更详细地研究了使用量子电路近似任意幺正操作的硬度。特别是，Knill得到了比我们更严格和更一般的界，他的分析也适用于全称集是门的连续统的情况，而不仅仅是有限集，正如我们所考虑的那样。